### What is composition and how to create it?

[Composition](https://developer.android.com/develop/ui/compose/lifecycle#composition-anatomy) represents the UI of your app and is generated by executing Composable functions. It organizes the UI into a tree structure of Composables, leveraging a **Composer** to create and manage this tree dynamically. The Composition records the state and applies necessary changes to the node tree to update the UI efficiently, a process known as **recomposition**. In essence, Composition serves as the backbone of Jetpack Compose, managing both the UI structure and the state of Composable functions at runtime.

#### Creating a Composition

A **Composition** refers to the process of converting Composable functions into a UI hierarchy that can be rendered on the screen. The Composition is at the core of how Jetpack Compose works, enabling the framework to track changes in state and update the UI efficiently. Here’s how you can create and manage a Composition:

#### Using the `ComponentActivity.setContent` Function

The most common way to create a Composition is by using the `setContent` function, which is provided by the `ComponentActivity` or `ComposeView`. This function initializes the Composition and defines the content to be displayed within it.

```kotlin
import androidx.activity.ComponentActivity
import androidx.compose.runtime.Composable
import androidx.compose.ui.platform.setContent

class MainActivity : ComponentActivity() {
    override fun onCreate(savedInstanceState: Bundle?) {
        super.onCreate(savedInstanceState)

        setContent {
            MyComposableContent()
        }
    }
}

@Composable
fun MyComposableContent() {
    // Define your UI components here
}
```

In this example:
- The `setContent` function creates the Composition.
- `MyComposableContent` is a Composable function that defines the UI to render.

However, if you examine the internal implementation of `ComponentActivity.setContent`, you’ll notice that it ultimately utilizes `ComposeView.setContent` to initialize and create the Composition:

```kotlin
public fun ComponentActivity.setContent(
    parent: CompositionContext? = null,
    content: @Composable () -> Unit
) {
    val existingComposeView = window.decorView
        .findViewById<ViewGroup>(android.R.id.content)
        .getChildAt(0) as? ComposeView

    if (existingComposeView != null) with(existingComposeView) {
        setParentCompositionContext(parent)
        setContent(content)
    } else ComposeView(this).apply {
        // Set content and parent **before** setContentView
        // to have ComposeView create the composition on attach
        setParentCompositionContext(parent)
        setContent(content)
        // Set the view tree owners before setting the content view so that the inflation process
        // and attach listeners will see them already present
        setOwners()
        setContentView(this, DefaultActivityContentLayoutParams)
    }
}
```

#### Embedding Compose in XML Layouts

If you want to integrate Compose into a traditional Android View hierarchy, you can use `ComposeView`. This allows you to create a Composition within an XML-defined layout.

```kotlin
import androidx.compose.ui.platform.ComposeView

val composeView = ComposeView(context).apply {
    setContent {
        MyComposableContent()
    }
}
```

You can add this `ComposeView` to an existing ViewGroup or include it in your XML layouts using the `<androidx.compose.ui.platform.ComposeView>` tag.

#### Summary

Composition is the process of building and managing a hierarchical structure of the UI by executing Composable functions. Creating a Composition involves defining your UI with Composable functions and initializing the Composition using mechanisms like `ComponentActivity.setContent`, or `ComposeView.setContent`.